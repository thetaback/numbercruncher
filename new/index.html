<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    -->
    <style>
        img.levelimage {
            height: 120px
        }
        figcaption.level {
            text-align: center
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/solar/bootstrap.min.css" rel="stylesheet">
	<title>Number Cruncher</title>
	<link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.e14c2b227c.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.e14c2b227c.png">
	<link rel="icon" type="image/png" sizes="48x48" href="../images/favicon-48x48.e14c2b227c.png">
	<link rel="icon" type="image/png" sizes="64x64" href="../images/favicon-64x64.e14c2b227c.png">
</head>
<body>
    <div class="container">
    <h1 class="mt-3 text-light">Create Game</h1>
    <form id="createGameInfo">
      <div class="row">
        <div class="col-md-2 mt-3">
            <label class="col-form-label">
                <h4 class="text-light">Select Difficulty:</h4>
            </label>
        </div>
        <div class="col-md-4 form-check mt-3">
          <div class="btn-group d-flex" role="group" aria-label="Select Difficulty">
              <input type="radio" class="btn-check form-check-input" name="difficulty" 
                              value="easy" id="btnradio1" autocomplete="off" checked="">
              <label class="btn btn-outline-success fs-4" for="btnradio1" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="Takes about 3-8min with all levels">Easy ⓘ</label>
              <input type="radio" class="btn-check form-check-input" name="difficulty" 
                              value="medium" id="btnradio2" autocomplete="off" >
              <label class="btn btn-outline-primary fs-4" for="btnradio2" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="Takes about 8-11min with all levels">Medium ⓘ</label>
              <input type="radio" class="btn-check form-check-input" name="difficulty" 
                              value="hard" id="btnradio3" autocomplete="off" >
              <label class="btn btn-outline-danger fs-4" for="btnradio3" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="Takes 11min+ with all levels">Hard ⓘ</label>
          </div>
        </div>
        <div class="col-md-2 mt-3">
            <label for="seed" class="col-form-label">
                <h4 class="text-light" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="A string of lowercase letters; i.e. 'qwerty', 'guacamole'">Select Seed: ⓘ</h4>
            </label>
        </div>
        <div class="col-md-4 mt-3">
            <input type="text" name="seed" id="seed" class="form-control">
        </div>
      </div>
      <h4 class="text-light mt-3">Select Levels:</h4>
      <div class="row mx-3">
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_01" id="Level_01" checked>
            <label class="form-check-label" for="Level_01">
              <figure>
                <img src="../images/NCLevel1small.png" class="levelimage">
                <figcaption class="level">Level 1</figcaption>
              </figure>
            </label>
          </div>
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_02" id="Level_02" checked>
            <label class="form-check-label" for="Level_02">
              <figure>
                <img src="../images/NCLevel2small.png" class="levelimage">
                <figcaption class="level">Level 2</figcaption>
              </figure>
            </label>
          </div>
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_03" id="Level_03" checked>
            <label class="form-check-label" for="Level_03">
              <figure>
                <img src="../images/NCLevel3small.png" class="levelimage">
                <figcaption class="level">Level 3</figcaption>
              </figure>
            </label>
          </div>
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_04" id="Level_04" checked>
            <label class="form-check-label" for="Level_04">
              <figure>
                <img src="../images/NCLevel4small.png" class="levelimage">
                <figcaption class="level">Level 4</figcaption>
              </figure>
            </label>
          </div>
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_05" id="Level_05" checked>
            <label class="form-check-label" for="Level_05">
              <figure>
                <img src="../images/NCLevel5small.png" class="levelimage">
                <figcaption class="level">Level 5</figcaption>
              </figure>
            </label>
          </div>
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_06" id="Level_06" checked>
            <label class="form-check-label" for="Level_06">
              <figure>
                <img src="../images/NCLevel6small.png" class="levelimage">
                <figcaption class="level">Level 6</figcaption>
              </figure>
            </label>
          </div>
          <div class="form-check col-md-4 col-lg-3 mt-3">
            <input class="form-check-input" type="checkbox" value="" 
                                      name="Level_07" id="Level_07" checked>
            <label class="form-check-label" for="Level_07">
              <figure>
                <img src="../images/NCLevel7small.png" class="levelimage">
                <figcaption class="level">Level 7</figcaption>
              </figure>
            </label>
          </div>
          <div class="col-md-4 col-lg-3">
              <button class="btn btn-primary mx-auto w-100 m-3" type="submit">Create Game</button>
              <div class="g-3" id="submitalert">
              </div>
          </div>
      </div>
    </form>
        <footer class="text-center mt-3 mb-1">
          Designed and developed by Theta Back, 2024. <a href="../about/">More info</a>
        </footer>
    </div>
    <script type="module" src="../ncclient.mjs"></script>
    <script type="module">
      import {ensureLoggedInUser, createGame, failureAlert} from "../ncclient.mjs";
      await ensureLoggedInUser();
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
      export async function _createGame(event) {
        event.preventDefault();
        const formdata = new FormData(event.target);
        const e = Array.from(formdata.entries());
        const d = formdata.get("difficulty");
        const s = formdata.get("seed");
        let ls = [];
        for (const [k, v] of e) {
          if (k.startsWith("Level")) {
            ls.push(k);
          }
        }
        if (ls.length == 0) {
          failureAlert({message:"Please select at least one level."}, "submitalert")
          return
        }
        if (s == "") {
          failureAlert({message:"Please enter a seed (ex. 'jellybean')."}, "submitalert")
          return
        }
        ls = ls.join(" ");
        try {
          const cr = await createGame(d, s, ls);
          console.log(cr);
          sessionStorage.currentGame = JSON.stringify(cr);
          window.location.href = "../view";
        } catch (er) {
          console.dir(er);
          failureAlert(er, "submitalert");
        }
        // console.log(e)
        // console.log(Object.fromEntries(formdata))
        // console.log("you MAdE A gaMe");
        return false;
      }
      document.getElementById("createGameInfo").onsubmit=_createGame;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
