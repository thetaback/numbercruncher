<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    -->
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/solar/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
    <h1 class="mt-3">Teacher Game Selection</h1>
    <form id="createGameInfo">
      <div class="row">
        <div class="col-md-2 form-check">
            <label class="col-form-label">
              Select difficulty: 
            </label>
        </div>
        <div class="col-md-4 form-check">
            <div class="btn-group" role="group" aria-label="Select Difficulty">
              <input type="radio" class="btn-check form-check-input" name="difficulty" 
                              value="easy" id="btnradio1" autocomplete="off" checked="">
              <label class="btn btn-outline-primary" for="btnradio1">Easy</label>
              <input type="radio" class="btn-check form-check-input" name="difficulty" 
                              value="medium" id="btnradio2" autocomplete="off" >
              <label class="btn btn-outline-primary" for="btnradio2">Medium</label>
              <input type="radio" class="btn-check form-check-input" name="difficulty" 
                              value="hard" id="btnradio3" autocomplete="off" >
              <label class="btn btn-outline-primary" for="btnradio3">Hard</label>
            </div>
        </div>
        <div class="col-md-2">
            <label for="seed" class="col-form-label">Select seed: </label>
        </div>
        <div class="col-md-4">
            <input type="text" name="seed" id="seed" class="form-control">
        </div>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_01" id="Level_01" checked>
        <label class="form-check-label" for="Level_01">
          Level 1
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_02" id="Level_02" checked>
        <label class="form-check-label" for="Level_02">
          Level 2
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_03" id="Level_03" checked>
        <label class="form-check-label" for="Level_03">
          Level 3
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_04" id="Level_04" checked>
        <label class="form-check-label" for="Level_04">
          Level 4
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_05" id="Level_05" checked>
        <label class="form-check-label" for="Level_05">
          Level 5
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_06" id="Level_06" checked>
        <label class="form-check-label" for="Level_06">
          Level 6
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" 
                                  name="Level_07" id="Level_07" checked>
        <label class="form-check-label" for="Level_07">
          Level 7
        </label>
      </div>
      <div class="col g-3">
        <button class="btn btn-primary" type="submit">Create Game</button>
      </div>
      <div class="col g-3" id="submitalert">
      </div>
    </form>
    </div>
    <script type="module" src="../ncclient.mjs"></script>
    <script type="module">
      import {ensureLoggedInUser, createGame, failureAlert} from "../ncclient.mjs";
      await ensureLoggedInUser();
      export async function _createGame(event) {
        event.preventDefault();
        const formdata = new FormData(event.target);
        const e = Array.from(formdata.entries());
        const d = formdata.get("difficulty");
        const s = formdata.get("seed");
        let ls = [];
        for (const [k, v] of e) {
          if (k.startsWith("Level")) {
            ls.push(k);
          }
        }
        if (ls.length == 0) {
          failureAlert({message:"Please select at least one level."}, "submitalert")
          return
        }
        if (s == "") {
          failureAlert({message:"Please enter a seed (ex. 'jellybean')."}, "submitalert")
          return
        }
        ls = ls.join(" ");
        try {
          const cr = await createGame(d, s, ls);
          console.log(cr);
          sessionStorage.currentGame = JSON.stringify(cr);
          window.location.href = "../view";
        } catch (er) {
          console.dir(er);
          failureAlert(er, "submitalert");
        }
        // console.log(e)
        // console.log(Object.fromEntries(formdata))
        // console.log("you MAdE A gaMe");
        return false;
      }
      document.getElementById("createGameInfo").onsubmit=_createGame;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
